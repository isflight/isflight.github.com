M.add("www-banner",function(e){function t(t,o){function a(){var e,n,i=[];for(e=0,n=c.size();n>e;++e)i.push('<li class="trigger-item"></li>');t.appendChild('<ul class="trigger ui-slider__triggers ui-slider__triggers--translucent ui-slider__triggers--small" style="display:none">'+i.join("")+"</ul>"),s=t.one(".trigger"),d=s.all("li")}var r,s=t.one(o.triggerContainer||".trigger"),l=t.one(o.sheetContainer||".sheet"),d=s&&s.all("> li"),c=l&&l.all("> li"),g={effect:"slideUp",interval:5e3};o.alwayson||(t.append('<a href="javascript:void(0)" class="F-glob F-glob-close common-close--iconfont-small close" title="关闭"></a>'),t.delegate("click",function(o){o.preventDefault(),r&&r.pause(),t.remove(!0),n&&8>n&&i.reflow(),e.Global.fire("PageHeight:change")},".close")),!c||c.size()<2||((!d||d.isEmpty())&&a(),o.triggerContainer=s,o.sheetContainer=l,o.srcNode=t,e.mix(o,g),e.use("w-slider",function(e){r=new e.mt.widget.Slider(o),r.render()}))}var n=e.UA.ie,i=e.mt.util,o=i.Cookie,a=e.mt.BigRender;e.mt.www.Banner={init:function(n){var o="J-banner-stamp-active";if(n=e.one(n),n&&!n.hasClass(o)){n.addClass(o);var r=i.decodeAttr(n,"banner-conf")||{};a.loadImmediately(n),t(n,r)}},Leftside:{success:function(t,n){var i=e.Node.create(n.html),o=M.PAGE_VIEW_DATA.page,a={};switch(e.one("body").prepend(i),o){case"index/nav":case"index/floor":a={topEdge:e.one(".site-fs").getY()+134,vTopOffset:100,vBottomOffset:200};break;case"s/default":a={topEdge:"#content"}}e.mt.www.Banner.Leftside.bindStickEvent(i,a,n.cn)},bindStickEvent:function(t,n,i){var a,r={vAlign:"top",vTopOffset:200,mainAreaWidth:980,hAlign:"right",vBottomOffset:140,bottomEdge:".site-info-w",side:"left",hideWhenTooNarrow:!0};n&&e.mix(r,n,!0),"undefined"==typeof r.topEdge&&(r.topEdge=e.one("#content").getY()-89),e.use("uix-sticky",function(e){a=new e.mt.uix.Sticky(t,r),t.delegate("click",function(e){e.halt();var n=o.getExpiresDate(1,0,0);t.remove(!0),a.destroy(),o.set(i,"1",n,"/","."+M.DOMAIN_HOST)},".close")})}},Unfold:{success:function(t,n,i){var o,a=i.node,r=e.one(".J-banner-newtop"),s=e.mt.www.Banner;r&&r.remove(!0),o=a.ancestor().insertBefore(n.html,a),s.Unfold._animate(o,n.cn,n.cv),s.init(o)},_animate:function(t,a,r){function s(t,n){var i=e.one(new Image);i.on("load",function(){n(t,i.get("height")),i.remove(!0)}),i.set("src",t),i.setStyles({position:"absolute",bottom:"-400px",left:0,visibility:"hidden",zIndex:-1})}var l,d=t.one("img"),c=t.one("a"),g=d.get("width"),f=d.get("height"),u=4e3,h=.3;o.set(a,r,o.getExpiresDate(10950,0,0),"/","."+M.DOMAIN_HOST),d.setAttribute("src",d.getData("fold-src")),t.setStyles({backgroundColor:t.getData("bg-color"),width:"100%"}),s(d.getData("unfold-src"),function(o,a){function r(){t.setStyle("height",a),i.reflow(),window.setTimeout(function(){d.set("height",f),t.setStyle("height",f),d.setAttribute("src",d.getData("fold-src")),i.reflow()},u)}function s(){if(t._node){var n=e.Node.create('<div style="width:100%;height:0;position:absolute;left:0;top:0;overflow:hidden"></div>'),i=e.Node.create('<img src="'+d.getData("fold-src")+'" width="'+g+'" height="'+f+'"/>');n.appendChild(c.cloneNode().append(i)),t.appendChild(n),new e.Anim({node:n,duration:h,to:{height:f}}).run().on("end",function(){m()}),l.set("to",{height:f}),l.on("end",function(){m(),t.one(".close")&&n.append(t.one(".close"))}),l.run()}}function m(){w&&(c.remove(!0),c=null),e.Global.fire("PageHeight:change"),w=!0}var w=!1;return d.setAttribute("src",o),d.set("height",a),8>n&&n>0?(r(),void e.Global.fire("PageHeight:change")):(l=new e.Anim({node:t,duration:h,to:{height:a}}),l.on("end",function(){l.detachAll(),e.Global.fire("PageHeight:change"),window.setTimeout(function(){s()},u)}),void l.run())})}}}},"1.0.0",{requires:["www-base","mt-bigrender"]});
;