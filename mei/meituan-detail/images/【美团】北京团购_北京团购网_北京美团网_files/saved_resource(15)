M.add("uix-sticky",function(t){function i(i,e){var o={mainAreaWidth:980,hideWhenTooNarrow:!1,canDisappear:!1,hAlign:"left",hLeftOffset:10,hRightOffset:10,vAlign:"top",vTopOffset:0,vBottomOffset:0,vMinScrollTop:0,topEdge:null,isStaticBottomEdge:!1,bottomEdge:"#ft",side:"right"};if(e.topEdge&&t.Lang.isNumber(e.topEdge)===!1){var n=t.one(e.topEdge);n&&(this._topEdgeNode=n,e.topEdge=n.getY())}if(this.ndHost=t.one(i),this.config=t.merge(o,e),!this.ndHost)throw new Error("Y.mt.uix.Sticky: 没有设置ndHost或ndHost不存在");if(t.Lang.isNumber(this.config.bottomEdge)&&!this.config.isStaticBottomEdge)throw new Error("Y.mt.uix.Sticky: isStaticBottomEdge为false时，bottomEdge不能为数字");var s=t.mt.UIUtil.getDimensions(i);this._hostHeight=s.offsetHeight,this._hostWidth=s.offsetWidth,this._topEdge=this.config.topEdge,this._delta=10,this.shouldShow={horizontal:!0,vertical:!0},this._handlers={},this._bindEvent()}var e=t.mt.util,o=6===t.UA.ie,n="px";i.prototype={_bindEvent:function(){function i(){n._destroy||(n._handleDisplay(),n._alignVertical())}function o(){n._destroy||(n._handleDisplay(),n._alignVertical(),n._alignHorizontal())}var n=this;n._align(),n._handleDisplay(),t.Global.on("PageHeight:change",function(){window.setTimeout(function(){n.config.isStaticBottomEdge&&n._getBottomEdge(!0),i()},50)}),window.setTimeout(o,200),t.mt.util.addLoadListener(function(){n._getBottomEdge(!0)});var s=t.one(window);this._handlers.scroll=s.on("scroll",e.throttle(i)),this._handlers.resize=s.on("resize",e.throttle(o))},isVisible:function(){var t=this;return t.shouldShow.vertical&&t.shouldShow.horizontal},_hideCanDisappear:function(){if(this.config.canDisappear){var t=this.ndHost,i=this.config.vMinScrollTop,e=parseInt(t.get("docScrollY"),10);this.shouldShow.vertical=e>=i}},_hideWhenNarrow:function(){if(this.config.hideWhenTooNarrow){var i,e=this._hostWidth,o=t.one(window).get("winWidth"),n=this.config,s=parseInt(n.mainAreaWidth,10),h=parseInt(n.hLeftOffset,10),a=parseInt(n.hRightOffset,10);i="right"===n.hAlign?a:h,this.shouldShow.horizontal=(o-s)/2>=e+i}},_handleDisplay:function(){var t=this.ndHost;this._hideCanDisappear(),this._hideWhenNarrow(),this.isVisible()?t.show():t.hide()},_alignHorizontal:function(){if(this.isVisible()){var i=this,e=i.ndHost,o=i.config,s=parseInt(o.mainAreaWidth,10),h=parseInt(o.hLeftOffset,10),a=parseInt(o.hRightOffset,10),r=t.one(window),d=r.get("winWidth"),g=i._hostWidth;"right"===o.side?"right"===o.hAlign?e.setStyle("right",o.hRightOffset+n):g+h>(d-s)/2?e.setStyle("left",d-g-h+n):e.setStyle("left",(d+s)/2+h+n):"left"===o.hAlign?e.setStyle("left",h+n):g+a>(d-s)/2?e.setStyle("right",d-g-a+n):e.setStyle("right",(d+s)/2+a+n)}},_alignVertical:function(){if(this.isVisible()){var i,e,s=this,h=this.config,a=this.ndHost,r=t.one(window),d=r.get("winHeight"),g=parseInt(h.vBottomOffset,10),l=h.vAlign,f=a.get("docScrollY"),c=parseInt(s._getBottomEdge(),10),_=s._topEdge,p=s._topEdgeNode,m=s._delta,u=s._hostStyleTop,w=s._hostHeight;p&&(_=p.getY());var E=f+d-c;o?("bottom"===l?(i=f+d-(g+w),_&&_>i?i=_:E>0&&(i-=E)):(i=f+u,c&&w+i+g>c?i=c-w-g:_&&_>i?i=_:E>0&&i+w>c&&(i=c-w-m)),a.setStyle("top",i+n)):"bottom"===l?(e=g,_&&_-f>d-(w+e)?e=d-(_-f)-w:E>0&&(e+=E),a.setStyle("bottom",e+n)):(i=u,c&&f+w+i+g>c?i=c-f-w-g:_&&_>f+i?i=_-f:E>0&&f+i+w>c&&(i=c-f-w-m),a.setStyle("top",i+n))}},_align:function(){var i=this,e=i.config,o=i._delta,n=parseInt(e.vTopOffset,10),s=n,h=t.one(window),a=h.get("winHeight"),r=i._hostHeight;s&&(s=n+r>a?a-r-o:n),i._hostStyleTop=s,i._alignVertical(),i._alignHorizontal()},_getBottomEdge:function(i){var e=this,o=this.config,n=o.bottomEdge,s=o.isStaticBottomEdge,h=e.ndHost.get("docHeight"),a=t.one(n),r=n;if(s){if(e._staticBottomEdge&&!i)return e._staticBottomEdge;r=t.Lang.isNumber(n)?parseInt(n,10):a?a.getY():h,e._staticBottomEdge=r}else r=a?a.getY():h;return r},destroy:function(){this._destroy=!0,e.detachHandle(this._handlers)}},t.namespace("mt.uix"),t.mt.uix.Sticky=i},"1.0.0",{requires:["mt-base","mt-uiutil","node"]});
;